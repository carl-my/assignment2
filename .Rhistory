}
}
return(as_tibble(test_gamma))
}
gammaUpdate(x, mu, sigma, pi)
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
pdf
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
pdf
test_gamma = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
test_gamma[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
test_gamma = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
test_gamma[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(test_gamma))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
gammaUpdate(x, mu, sigma, pi)
x
library(StatProg)
library(tidyverse)
galaxies <- as.data.frame(galaxies)
names(galaxies) <- "km"
ggplot(galaxies, aes(x = km)) +
geom_density()
x = as.numeric(galaxies)
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
test = gammaUpdate(x, mu, sigma, pi)
library(StatProg)
library(tidyverse)
galaxies <- as.data.frame(galaxies)
names(galaxies) <- "km"
ggplot(galaxies, aes(x = km)) +
geom_density()
x = as.numeric(galaxies)
galaxies
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
gammaUpdate(x = galaxies, mu, sigma, pi)
View(galaxies)
length(galaxies)
x = as.data.frame(galaxies)
length(galaxies)
x = as.numeric(galaxies)
x = as.numeric(data("galaxies"))
x = as.numeric(data("galaxies"))
x = data("galaxies")
data("galaxies")
x <- as.data.frame(galaxies)
View(x)
names(galaxies) <- "km"
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
gammaUpdate(x, mu, sigma, pi)
length(x)
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = nrow(x)))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
gammaUpdate(x, mu, sigma, pi)
nrow(x)
length(mu)
nrow(x)
nrow(x)
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = nrow(x)))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
gammaUpdate(x, mu, sigma, pi)
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
pdf
x <- as.data.frame(galaxies)
x
x <- as.numeric(as.data.frame(galaxies))
x <- as.data.frame(galaxies)
galaxies
data("galaxies")
galaxies
x = as.numeric(galaxies)
x
x <- as.data.frame(x)
names(galaxies) <- "km"
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = nrow(x)))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
gammaUpdate(x, mu, sigma, pi)
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
pdf
gammaUpdate = function(x, mu, sigma, pi){
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = nrow(x)))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
gammaUpdate(x, mu, sigma, pi)
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
pdf
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
pdf[82, 3]
pdf[82, 3]
pdf[2, 82]
pdf
pdf[82, 2]
pdf[80, 2]
pdf[1, 2]
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
[1, 2]
pdf[1, 2]
library(StatProg)
library(tidyverse)
data("galaxies")
x = as.numeric(galaxies)
x <- as.data.frame(x)
names(galaxies) <- "km"
ggplot(galaxies, aes(x = km)) +
geom_density()
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = nrow(x)))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
gammaUpdate(x, mu, sigma, pi)
t(sapply(x, dnorm, mean = mu, sd = sigma))
gammaUpdate = function(x, mu, sigma, pi){
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = nrow(x)))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
gammaUpdate(x, mu, sigma, pi)
sapply(x, dnorm, mean = mu, sd = sigma)
pdf[1, 2]
pdf
x
data("galaxies")
x = as.numeric(galaxies)
ggplot(galaxies, aes(x = km)) +
geom_density()
gammaUpdate = function(x, mu, sigma, pi){
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
pdf[1, 2] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = nrow(x)))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
gammaUpdate(x, mu, sigma, pi)
length(x)
gammaUpdate = function(x, mu, sigma, pi){
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[1, 2] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
gammaUpdate(x, mu, sigma, pi)
data("galaxies")
x = as.numeric(galaxies)
gammaUpdate = function(x, mu, sigma, pi){
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[1, 2] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
gammaUpdate(x, mu, sigma, pi)
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[1, 2] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
gammaUpdate(x, mu, sigma, pi)
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[1, 2] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as.data.frame(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
gammaUpdate(x, mu, sigma, pi)
ncol(test)
test = gammaUpdate(x, mu, sigma, pi)
ncol(test)
nrow(test)
ggplot(data = test) +
geom_density(aes(x = rownames(test)))
test
ggplot(data = test) +
geom_density(aes(x = as.numeric(row.names(test))))
ggplot(data = test[,1]) +
geom_density(aes(x = as.numeric(row.names(test))))
ggplot(data = test[,1]) +
geom_density(aes(x = as.numeric(row.names(test))))
library(StatProg)
library(tidyverse)
data("galaxies")
x = as.numeric(galaxies)
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[1, 2] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as.data.frame(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
test = gammaUpdate(x, mu, sigma, pi)
test
sum(test[,1])
sum(test[1,])
for(i in nrow(test)){
sum(test[i,])
}
for(i in nrow(test)){
print(sum(test[i,]))
}
nrow(test)
for(i in 1:nrow(test)){
print(sum(test[i,]))
}
n = 0
for(i in 1:nrow(test)){
print(sum(test[i,]))
n = n +1
}
n
mu = c(10, 20, 32)
sigma = c(1, 2, 3)
test = gammaUpdate(x, mu, sigma, pi)
test
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as.data.frame(gam))
}
test = gammaUpdate(x, mu, sigma, pi)
test
sum(test[1,])
sum(test[, 1])
mu = c(10, 20, 30)
sigma = c(2, 2, 2)
pi = c(1/3, 1/3, 1/3)
test = gammaUpdate(x, mu, sigma, pi)
test[1,]
library(StatProg)
library(tidyverse)
galaxies <- as.data.frame(galaxies)
names(galaxies) <- "km"
ggplot(galaxies, aes(x = km)) +
geom_density()
x = galaxies$km
x
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as.data.frame(gam))
}
mu = c(10, 20, 30)
sigma = c(2, 2, 2)
pi = c(1/3, 1/3, 1/3)
resp = gammaUpdate(x, mu, sigma, pi)
resp[1,]
galaxies <- as.data.frame(galaxies)
names(galaxies) <- "km"
ggplot(galaxies, aes(x = km)) +
geom_density()
x = galaxies$km
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as.data.frame(gam))
}
mu = c(10, 20, 30)
sigma = c(2, 2, 2)
pi = c(1/3, 1/3, 1/3)
resp = gammaUpdate(x, mu, sigma, pi)
resp[1,]
