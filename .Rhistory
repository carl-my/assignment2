test_gamma = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(pi)){
test_gamma[n, k] = pdf[n,k]/sum(pdf[,n])
}
}
test_gamma[82, 2]
test_gamma[82, 2] = pdf[82,2]/sum(pdf[,2])
pdf[82,2]
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
for(k in 1:length(mu)){
for(n in 1:length(x)){
pdf[k,n] = pi[k]*pdf[k, n]
}
}
pdf[82,2]
gammaUpdate = function(x, mu, sigma, pi){
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
for(k in 1:length(mu)){
for(n in 1:length(x)){
pdf[n, k] = pi[k]*pdf[k, n]
}
}
test_gamma = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(pi)){
test_gamma[n, k] = pdf[n, k]/sum(pdf[,n])
}
}
return(as_tibble(test_gamma))
}
gammaUpdate(x, mu, sigma, pi)
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
for(k in 1:length(mu)){
for(n in 1:length(x)){
pdf[n, k] = pi[k]*pdf[k, n]
}
}
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[k, n]
}
}
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
for(n in 1:length(x)){
pdf[k, n] = pi[k]*pdf[k, n]
}
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
for(k in 1:length(mu)){
for(n in 1:length(x)){
pdf[k, n] = pi[k]*pdf[k, n]
}
}
pdf
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
pdf
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
pdf
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
test_gamma
for(k in 1:length(pi)){
for(n in 1:length(x)){
test_gamma[n, k] = pdf[n, k]/sum(pdf[,n])
}
}
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
pdf
test_gamma = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(k in 1:length(pi)){
for(n in 1:length(x)){
test_gamma[n, k] = pdf[n, k]/sum(pdf[,n])
}
}
for(n in 1:length(x)){
for(k in 1:length(mu)){
test_gamma[n, k] = pdf[n, k]/sum(pdf[,n])
}
}
for(n in 1:length(x)){
for(k in 1:length(mu)){
test_gamma[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
test_gamma = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
test_gamma[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(test_gamma))
}
gammaUpdate(x, mu, sigma, pi)
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
test_gamma = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
test_gamma[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(test_gamma))
}
gammaUpdate(x, mu, sigma, pi)
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
pdf
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
pdf
test_gamma = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
test_gamma[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
test_gamma = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
test_gamma[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(test_gamma))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
gammaUpdate(x, mu, sigma, pi)
x
library(StatProg)
library(tidyverse)
galaxies <- as.data.frame(galaxies)
names(galaxies) <- "km"
ggplot(galaxies, aes(x = km)) +
geom_density()
x = as.numeric(galaxies)
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
test = gammaUpdate(x, mu, sigma, pi)
library(StatProg)
library(tidyverse)
galaxies <- as.data.frame(galaxies)
names(galaxies) <- "km"
ggplot(galaxies, aes(x = km)) +
geom_density()
x = as.numeric(galaxies)
galaxies
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
gammaUpdate(x = galaxies, mu, sigma, pi)
View(galaxies)
length(galaxies)
x = as.data.frame(galaxies)
length(galaxies)
x = as.numeric(galaxies)
x = as.numeric(data("galaxies"))
x = as.numeric(data("galaxies"))
x = data("galaxies")
data("galaxies")
x <- as.data.frame(galaxies)
View(x)
names(galaxies) <- "km"
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
gammaUpdate(x, mu, sigma, pi)
length(x)
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = nrow(x)))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
gammaUpdate(x, mu, sigma, pi)
nrow(x)
length(mu)
nrow(x)
nrow(x)
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = nrow(x)))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
gammaUpdate(x, mu, sigma, pi)
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
pdf
x <- as.data.frame(galaxies)
x
x <- as.numeric(as.data.frame(galaxies))
x <- as.data.frame(galaxies)
galaxies
data("galaxies")
galaxies
x = as.numeric(galaxies)
x
x <- as.data.frame(x)
names(galaxies) <- "km"
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = nrow(x)))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
gammaUpdate(x, mu, sigma, pi)
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
pdf
gammaUpdate = function(x, mu, sigma, pi){
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = nrow(x)))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
gammaUpdate(x, mu, sigma, pi)
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
pdf
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
pdf[82, 3]
pdf[82, 3]
pdf[2, 82]
pdf
pdf[82, 2]
pdf[80, 2]
pdf[1, 2]
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
[1, 2]
pdf[1, 2]
library(StatProg)
library(tidyverse)
data("galaxies")
x = as.numeric(galaxies)
x <- as.data.frame(x)
names(galaxies) <- "km"
ggplot(galaxies, aes(x = km)) +
geom_density()
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = nrow(x)))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
gammaUpdate(x, mu, sigma, pi)
t(sapply(x, dnorm, mean = mu, sd = sigma))
gammaUpdate = function(x, mu, sigma, pi){
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
pdf[n, k] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = nrow(x)))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
gammaUpdate(x, mu, sigma, pi)
sapply(x, dnorm, mean = mu, sd = sigma)
pdf[1, 2]
pdf
x
data("galaxies")
x = as.numeric(galaxies)
ggplot(galaxies, aes(x = km)) +
geom_density()
gammaUpdate = function(x, mu, sigma, pi){
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
pdf[1, 2] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = nrow(x)))
for(n in 1:nrow(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
gammaUpdate(x, mu, sigma, pi)
length(x)
gammaUpdate = function(x, mu, sigma, pi){
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[1, 2] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
gammaUpdate(x, mu, sigma, pi)
data("galaxies")
x = as.numeric(galaxies)
gammaUpdate = function(x, mu, sigma, pi){
pdf = sapply(x, dnorm, mean = mu, sd = sigma)
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[1, 2] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
gammaUpdate(x, mu, sigma, pi)
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[1, 2] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as_tibble(gam))
}
gammaUpdate(x, mu, sigma, pi)
gammaUpdate = function(x, mu, sigma, pi){
pdf = t(sapply(x, dnorm, mean = mu, sd = sigma))
for(n in 1:length(x)){
for(k in 1:length(mu)){
pdf[1, 2] = pi[k]*pdf[n, k]
}
}
gam = as.data.frame(matrix(NA, ncol = length(pi), nrow = length(x)))
for(n in 1:length(x)){
for(k in 1:length(mu)){
gam[n, k] = pdf[n, k]/sum(pdf[n,])
}
}
return(as.data.frame(gam))
}
mu = c(10000, 20000, 32000)
sigma = c(1000, 2000, 3000)
pi = c(1/3, 1/3, 1/3)
gammaUpdate(x, mu, sigma, pi)
ncol(test)
test = gammaUpdate(x, mu, sigma, pi)
ncol(test)
nrow(test)
ggplot(data = test) +
geom_density(aes(x = rownames(test)))
test
ggplot(data = test) +
geom_density(aes(x = as.numeric(row.names(test))))
ggplot(data = test[,1]) +
geom_density(aes(x = as.numeric(row.names(test))))
ggplot(data = test[,1]) +
geom_density(aes(x = as.numeric(row.names(test))))
